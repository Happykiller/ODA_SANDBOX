!function(){jQuery.fn.exists=function(){return this.length>0};var VERSION="0.150625";$.Oda={version:VERSION,Color:{INFO:"#5882FA",WARNING:"#f7931e",ERROR:"#B9121B",SUCCESS:"#AEEE00"},Session:{code_user:"",key:"",userInfo:{locale:"fr",firstName:"",lastName:"",mail:"",profile:0,profileLabel:"",showTooltip:0}},Context:{modeInterface:["cache","ajax","mokup","offline"],ModeExecution:{init:!1,scene:!1,notification:!1,popup:!1,message:!1,rooter:!1,app:!1},debug:!0,rootPath:"",projectLabel:"Project",mainDiv:"oda-content",host:"",rest:"",resources:"",window:window,console:console,startDate:!1},Regexs:{mail:"[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+(?:[A-Z]{2}|com|org|net|edu|gov|mil|biz|info|mobi|name|aero|asia|jobs|museum|fr)\\b",login:"^[a-zA-Z0-9]{3,}$",pass:"^[a-zA-Z0-9]{4,}$",fristName:"^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]{3,}$",lastName:"^[a-zA-ZàáâäãåąčćęèéêëėįìíîïłńòóôöõøùúûüųūÿýżźñçčšžÀÁÂÄÃÅĄĆČĖĘÈÉÊËÌÍÎÏĮŁŃÒÓÔÖÕØÙÚÛÜŲŪŸÝŻŹÑßÇŒÆČŠŽ∂ð ,.'-]{3,}$",noInjection:"^(?!.*?function())"},Cache:{config:[],cache:[],save:function(p_params){try{if(""!==$.Oda.Session.code_user){var founded=!1;for(var indice in $.Oda.Cache.config){var elt=$.Oda.Cache.config[indice];if(p_params.key.includes(elt.key)){founded=!0;break}}if(founded){$.Oda.Cache.cache=$.Oda.Storage.get("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache);var d=new Date,date=d.getTime();p_params.recordDate=date;for(var indice in $.Oda.Cache.cache){var elt=$.Oda.Cache.cache[indice];elt.key===p_params.key&&$.Oda.Tooling.deepEqual(elt.attrs,p_params.attrs)&&$.Oda.Cache.cache.splice(indice,1)}return $.Oda.Cache.cache.push(p_params),$.Oda.Storage.set("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache),this}return this}return this}catch(er){return $.Oda.Log.error("$.Oda.Cache.save : "+er.message),null}},load:function(p_params){try{if(""!==$.Oda.Session.code_user){var eltConfig,founded=!1;for(var indice in $.Oda.Cache.config)if(eltConfig=$.Oda.Cache.config[indice],p_params.key.includes(eltConfig.key)){if(eltConfig.hasOwnProperty("onDemande")&&eltConfig.onDemande&&p_params.demande){founded=!0;break}if(eltConfig.hasOwnProperty("onDemande")&&eltConfig.onDemande===!1||!eltConfig.hasOwnProperty("onDemande")){founded=!0;break}}if(founded){$.Oda.Cache.cache=$.Oda.Storage.get("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache);for(var indice in $.Oda.Cache.cache){var elt=$.Oda.Cache.cache[indice];if(elt.key===p_params.key&&$.Oda.Tooling.deepEqual(elt.attrs,p_params.attrs)){if(0!==eltConfig.ttl){var d=new Date,date=d.getTime(),dateTimeOut=elt.recordDate+1e3*eltConfig.ttl;return date>dateTimeOut?!1:elt}return elt}}}return!1}return!1}catch(er){return $.Oda.Log.error("$.Oda.Cache.load : "+er.message),null}},loadWithOutTtl:function(p_params){try{if(""!==$.Oda.Session.code_user){var founded=!1;for(var indice in $.Oda.Cache.config){var elt=$.Oda.Cache.config[indice];if(p_params.key.includes(elt.key)){founded=!0;break}}if(founded){$.Oda.Cache.cache=$.Oda.Storage.get("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache);for(var indice in $.Oda.Cache.cache){var elt=$.Oda.Cache.cache[indice];if(elt.key===p_params.key&&$.Oda.Tooling.deepEqual(elt.attrs,p_params.attrs))return elt}}return!1}return!1}catch(er){return $.Oda.Log.error("$.Oda.Cache.loadWithOutTtl : "+er.message),null}},remove:function(p_params){try{$.Oda.Cache.cache=$.Oda.Storage.get("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache);for(var indice in $.Oda.Cache.cache){var elt=$.Oda.Cache.cache[indice];if(elt.key===p_params.key&&$.Oda.Tooling.deepEqual(elt.attrs,p_params.attrs)){$.Oda.Cache.cache.splice(indice,1);break}}return $.Oda.Storage.set("ODA-CACHE-"+$.Oda.Session.code_user,$.Oda.Cache.cache),this}catch(er){return $.Oda.Log.error("$.Oda.Cache.remove : "+er.message),null}},clean:function(){try{return""!==$.Oda.Session.code_user&&$.Oda.Storage.remove("ODA-CACHE-"+$.Oda.Session.code_user),this}catch(er){return $.Oda.Log.error("$.Oda.Cache.clean : "+er.message),null}},cleanAll:function(){try{var listCache=$.Oda.Storage.getIndex("ODA-CACHE");for(var indice in listCache){var key=$.Oda.Tooling.replaceAll({str:listCache[indice],find:$.Oda.Storage.storageKey,by:""});$.Oda.Storage.remove(key)}return this}catch(er){return $.Oda.Log.error("$.Oda.Cache.cleanAll : "+er.message),null}}},Loader:{Status:{init:0,loading:1,loaded:2,fail:3},iterator:0,buffer:[],eltAlreadyLoad:{},load:function(params){try{var eltLoader=params;eltLoader.id=$.Oda.Loader.iterator;for(var indiceGrp in eltLoader.depends){var grp=eltLoader.depends[indiceGrp];grp.state=$.Oda.Loader.Status.init;for(var indiceElt in grp.list){var elt=grp.list[indiceElt];elt.state=$.Oda.Loader.Status.init}}return $.Oda.Loader.buffer.push(eltLoader),$.Oda.Loader.iterator++,$.Oda.Loader.loading({id:eltLoader.id}),this}catch(er){$.Oda.Log.error("$.Oda.Loader.load : "+er.message)}},loading:function(p_params){try{var eltLoader=$.Oda.Loader.buffer[p_params.id];for(var indiceGrp in eltLoader.depends){var grp=eltLoader.depends[indiceGrp];if(grp.state===$.Oda.Loader.Status.init)return $.Oda.Log.debug("Dependency group loading : "+grp.name),grp.state=$.Oda.Loader.Status.loading,$.Oda.Event.addListener({name:"oda-loader-"+p_params.id+"-"+grp.name,callback:function(e){return $.Oda.Loader.loading({id:e.detail.idLoader}),this}}),$.Oda.Loader.loadingGrp({idLoader:p_params.id,grp:grp}),this}return eltLoader.hasOwnProperty("functionFeedback")&&(eltLoader.hasOwnProperty("functionFeedbackParams")?eltLoader.functionFeedback(eltLoader.functionFeedbackParams):eltLoader.functionFeedback()),this}catch(er){return $.Oda.Log.error("$.Oda.Loader.loading : "+er.message),null}},loadingGrp:function(p_params){try{var statutGrp=$.Oda.Loader.Status.loaded;for(var indiceElt in p_params.grp.list){var elt=p_params.grp.list[indiceElt];if(elt.state===$.Oda.Loader.Status.init){if($.Oda.Log.debug("Dependency element loading : "+elt.elt+" of grp : "+p_params.grp.name),elt.state=$.Oda.Loader.Status.loading,$.Oda.Event.addListener({name:"oda-loader-"+p_params.idLoader+"-"+p_params.grp.name+"-"+elt.elt,callback:function(e){return $.Oda.Loader.loadingGrp({idLoader:e.detail.idLoader,grp:e.detail.grp}),this}}),$.Oda.Loader.loadingElt({idLoader:p_params.idLoader,grp:p_params.grp,elt:elt}),p_params.grp.ordered)return this}else elt.state===$.Oda.Loader.Status.fail&&(statutGrp=$.Oda.Loader.Status.fail)}if(!p_params.grp.ordered)for(var indiceElt in p_params.grp.list){var elt=p_params.grp.list[indiceElt];if(elt.state===$.Oda.Loader.Status.loading)return this}return p_params.grp.state!==$.Oda.Loader.Status.loaded&&(p_params.grp.state=statutGrp,$.Oda.Log.debug("Dependency group loaded : "+p_params.grp.name+" with code : "+p_params.grp.state),$.Oda.Event.send({name:"oda-loader-"+p_params.idLoader+"-"+p_params.grp.name,data:{grpName:p_params.grp.name,idLoader:p_params.idLoader,grpState:statutGrp}})),this}catch(er){return $.Oda.Log.error("$.Oda.Loader.loadingGrp : "+er.message),null}},loadingElt:function(p_params){try{if(p_params.elt.state!==$.Oda.Loader.Status.loaded)if(p_params.elt.hasOwnProperty("force")||(p_params.elt.force=!1),$.Oda.Loader.eltAlreadyLoad.hasOwnProperty(p_params.elt.elt)&&$.Oda.Loader.eltAlreadyLoad[p_params.elt.elt]===$.Oda.Loader.Status.loaded&&p_params.elt.force===!1)p_params.elt.state=$.Oda.Loader.Status.loaded,$.Oda.Log.debug("Dependency element already loaded : "+p_params.elt.elt+" of grp : "+p_params.grp.name+" of  with code : "+p_params.elt.state),$.Oda.Event.send({name:"oda-loader-"+p_params.idLoader+"-"+p_params.grp.name+"-"+p_params.elt.elt,data:{grp:p_params.grp,idLoader:p_params.idLoader}});else switch(p_params.elt.type){case"css":$("<link/>",{rel:"stylesheet",type:"text/css",href:p_params.elt.elt}).appendTo("head"),$.Oda.Loader.eltAlreadyLoad[p_params.elt.elt]=$.Oda.Loader.Status.loaded,p_params.elt.state=$.Oda.Loader.Status.loaded,$.Oda.Log.debug("Dependency element loaded : "+p_params.elt.elt+" of grp : "+p_params.grp.name+" of  with code : "+p_params.elt.state),$.Oda.Event.send({name:"oda-loader-"+p_params.idLoader+"-"+p_params.grp.name+"-"+p_params.elt.elt,data:{grp:p_params.grp,idLoader:p_params.idLoader}});break;case"script":case"json":case"html":$.ajax({url:p_params.elt.elt,dataType:p_params.elt.type,context:{params:p_params},success:function(data,textStatus,jqxhr){var params=$(this)[0].params;params.elt.hasOwnProperty("target")&&params.elt.target(data),$.Oda.Loader.eltAlreadyLoad[params.elt.elt]=$.Oda.Loader.Status.loaded,params.elt.state=$.Oda.Loader.Status.loaded,$.Oda.Log.debug("Dependency element loaded : "+params.elt.elt+" of grp : "+params.grp.name+" of  with code : "+params.elt.state),$.Oda.Event.send({name:"oda-loader-"+params.idLoader+"-"+params.grp.name+"-"+params.elt.elt,data:{grp:params.grp,idLoader:params.idLoader}})},error:function(jqxhr,settings,exception){var params=$(this)[0].params;$.Oda.Loader.eltAlreadyLoad[params.elt.elt]=$.Oda.Loader.Status.fail,params.elt.state=$.Oda.Loader.Status.fail,$.Oda.Log.debug("Dependency element fail : "+params.elt.elt+" of grp : "+params.grp.name+" of  with code : "+params.elt.state),$.Oda.Event.send({name:"oda-loader-"+params.idLoader+"-"+params.grp.name+"-"+params.elt.elt,data:{grp:params.grp,idLoader:params.idLoader}})}});break;default:$.Oda.Log.debug("Type unknown for : "+p_params.elt.elt+".")}return this}catch(er){return $.Oda.Log.error("$.Oda.Loader.loadingElt : "+er.message),null}}},init:function(){try{var listDepends=[{name:"library",ordered:!1,list:[{elt:$.Oda.Context.rootPath+"API/i8n/i8n.json",type:"json",target:function(p_json){$.Oda.I8n.datas=$.Oda.I8n.datas.concat(p_json)}},{elt:$.Oda.Context.rootPath+"API/css/css.css",type:"css"},{elt:$.Oda.Context.rootPath+"API/templates/Oda.html",type:"html",target:function(data){$("body").append(data)}}]}];if($.Oda.Context.ModeExecution.app){var listDependsApp=[{name:"app",ordered:!1,list:[{elt:$.Oda.Context.rootPath+"config/config.js",type:"script"},{elt:$.Oda.Context.rootPath+"css/css.css",type:"css"},{elt:$.Oda.Context.rootPath+"i8n/i8n.json",type:"json",target:function(p_json){$.Oda.I8n.datas=$.Oda.I8n.datas.concat(p_json)}},{elt:$.Oda.Context.rootPath+"js/OdaApp.js",type:"script"}]}];listDepends=listDepends.concat(listDependsApp)}if($.Oda.Context.ModeExecution.scene){$.Oda.Router.routesAllowedDefault=["","home","contact","forgot","subscrib","profile"],$.Oda.Router.routesAllowed=$.Oda.Router.routesAllowedDefault.slice(0),$.Oda.Router.addMiddleWare("support",function(){$.Oda.Log.debug("MiddleWares : support");{var tabInput={param_name:"maintenance"};$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/getParam.php",{functionRetour:function(data){try{var maintenance=data.data.leParametre.param_value;"1"===maintenance&&($.Oda.Router.routerExit=!0,$.Oda.Router.routes.support.go())}catch(e){$.Oda.Router.routerExit=!0,$.Oda.Router.routes.support.go()}}},tabInput)}}),$.Oda.Router.addMiddleWare("auth",function(){if($.Oda.Log.debug("MiddleWares : auth"),$.Oda.Session.hasOwnProperty("code_user")&&""!==$.Oda.Session.code_user)if($.Oda.Tooling.isInArray($.Oda.Router.current.route,$.Oda.Router.routesAllowed)){var tabInput={code_user:$.Oda.Session.code_user,key:$.Oda.Session.key};$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/checkSession.php",{functionRetour:function(data){data.data||($.Oda.Router.routerExit=!0,$.Oda.Security.logout())}},tabInput)}else $.Oda.Router.routerExit=!0,$.Oda.Security.logout();else{var session=$.Oda.Storage.get("ODA-SESSION");if(null!==session){$.Oda.Session=session;{var tabInput={code_user:session.code_user,key:session.key};$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/checkSession.php",{functionRetour:function(data){data.data?($.Oda.Security.loadRight(),$.Oda.Tooling.isInArray($.Oda.Router.current.route,$.Oda.Router.routesAllowed)||($.Oda.Router.routerExit=!0,$.Oda.Security.logout())):($.Oda.Router.routerExit=!0,$.Oda.Security.logout())}},tabInput)}}else{var params=$.Oda.Router.current.args;if(params.hasOwnProperty("getUser")&&params.hasOwnProperty("getPass")){var auth=$.Oda.Security.auth({login:params.getUser,mdp:params.getPass,reload:!1});auth?$.Oda.Tooling.isInArray($.Oda.Router.current.route,$.Oda.Router.routesAllowed)||($.Oda.Router.routerExit=!0,$.Oda.Security.logout()):($.Oda.Router.routerExit=!0,$.Oda.Security.logout())}else $.Oda.Router.routerExit=!0,$.Oda.Security.logout()}}}),$.Oda.Router.addDependencies("hightcharts",{ordered:!1,list:[{elt:$.Oda.Context.rootPath+"API/libs/highcharts-release/highcharts.js",type:"script"}]}),$.Oda.Router.addDependencies("dataTables",{ordered:!1,list:[{elt:$.Oda.Context.rootPath+"API/css/dataTables.bootstrap.css",type:"css"},{elt:$.Oda.Context.rootPath+"API/libs/datatables/media/js/jquery.dataTables.min.js",type:"script"},{elt:$.Oda.Context.rootPath+"API/js/dataTables/dataTables.bootstrap.js",type:"script"}]}),$.Oda.Router.addDependencies("ckeditor",{ordered:!1,list:[{elt:"//cdn.ckeditor.com/4.4.7/standard/ckeditor.js",type:"script"}]}),$.Oda.Router.addRoute("auth",{path:"API/partials/auth.html",title:"oda-main.authentification",urls:["auth"],middleWares:["support"],system:!0}),$.Oda.Router.addRoute("support",{path:"API/partials/support.html",title:"oda-main.support-title",urls:["support"],system:!0}),$.Oda.Router.addRoute("404",{path:"API/partials/404.html",title:"oda-main.404-title",urls:["404"],system:!0}),$.Oda.Router.addRoute("contact",{path:"API/partials/contact.html",title:"oda-main.contact",urls:["contact"],middleWares:["support"]}),$.Oda.Router.addRoute("forgot",{path:"API/partials/forgot.html",title:"oda-main.forgot-title",urls:["forgot"],middleWares:["support"]}),$.Oda.Router.addRoute("subscrib",{path:"API/partials/subscrib.html",title:"oda-main.subscrib-title",urls:["subscrib"],middleWares:["support"]}),$.Oda.Router.addRoute("home",{path:"API/partials/home.html",title:"oda-main.home-title",urls:["","home"],middleWares:["support","auth"]}),$.Oda.Router.addRoute("profile",{path:"API/partials/profile.html",title:"oda-main.profile-title",urls:["profile"],middleWares:["support","auth"]}),$.Oda.Router.addRoute("stats",{path:"API/partials/stats.html",title:"oda-stats.title",urls:["stats"],middleWares:["support","auth"],dependencies:["hightcharts"]}),$.Oda.Router.addRoute("admin",{path:"API/partials/admin.html",title:"oda-admin.title",urls:["admin"],middleWares:["support","auth"],dependencies:["dataTables","ckeditor"]}),$.Oda.Router.addRoute("supervision",{path:"API/partials/supervision.html",title:"oda-supervision.title",urls:["supervision"],middleWares:["support","auth"],dependencies:["dataTables"]});var listDependsScene=[{name:"scene",ordered:!1,list:[{elt:$.Oda.Context.rootPath+"API/css/simple-sidebar.css",type:"css"},{elt:$.Oda.Context.rootPath+"API/templates/Scene.html",type:"html",target:function(data){$("body").append(data)}}]}];listDepends=listDepends.concat(listDependsScene)}if($.Oda.Tooling.isInArray("mokup",$.Oda.Context.modeInterface)){var listDependsMokup=[{name:"mokup",ordered:!1,list:[{elt:$.Oda.Context.rootPath+"API/mokup/mokup.json",type:"json",target:function(p_json){$.Oda.MokUp.mokup=$.Oda.MokUp.mokup.concat(p_json)}},{elt:$.Oda.Context.rootPath+"mokup/mokup.json",type:"json",target:function(p_json){$.Oda.MokUp.mokup=$.Oda.MokUp.mokup.concat(p_json)}}]}];listDepends=listDepends.concat(listDependsMokup)}if($.Oda.Tooling.isInArray("cache",$.Oda.Context.modeInterface)){var listDependsCache=[{name:"cache",ordered:!1,list:[{elt:$.Oda.Context.rootPath+"API/cache/cache.json",type:"json",target:function(p_json){$.Oda.Cache.config=$.Oda.Cache.config.concat(p_json)}},{elt:$.Oda.Context.rootPath+"cache/cache.json",type:"json",target:function(p_json){$.Oda.Cache.config=$.Oda.Cache.config.concat(p_json)}}]}];listDepends=listDepends.concat(listDependsCache)}return $.Oda.Loader.load({depends:listDepends,functionFeedback:function(data){""!==$.Oda.Context.host&&($.Oda.Storage.storageKey="ODA__"+$.Oda.Context.host+"__"),$.Oda.Context.ModeExecution.notification&&$.Oda.Display.Notification.load(),$.Oda.Context.ModeExecution.popup&&$.Oda.Display.Popup.load(),$.Oda.Context.ModeExecution.scene&&($("#"+$.Oda.Context.mainDiv).exists()&&$("#"+$.Oda.Context.mainDiv).remove(),$.Oda.Display.Scene.load()),$.Oda.Context.ModeExecution.rooter&&$.Oda.Router.startRooter();var d=new Date,mili=(d.getTime(),d-$.Oda.Context.startDate.getTime());$.Oda.Log.info("Oda fully loaded. (in "+mili+" miliseconds)"),$.Oda.Event.send({name:"oda-fully-loaded",data:{truc:data.msg}})},functionFeedbackParams:{msg:"Welcome with Oda"}}),this}catch(er){return $.Oda.Log.error("$.Oda.init : "+er.message),null}},Mobile:{funcReturnGPSPosition:null,funcReturnCaptureImg:null,networkState:null,positionGps:{coords:{latitude:0,longitude:0,altitude:0,accuracy:0,altitudeAccuracy:0,heading:0,speed:0},timestamp:0,statut:""},pictureSource:null,destinationType:null,onMobile:!1,onMobileTest:!1,onSuccessGPSPosition:function(p_position){try{$.Oda.Mobile.positionGps.coords=p_position.coords,$.Oda.Mobile.positionGps.timestamp=p_position.timestamp,$.Oda.Mobile.positionGps.statut="OK",$.Oda.Mobile.funcReturnGPSPosition($.Oda.Mobile.positionGps)}catch(er){log(0,"ERROR($.Oda.Mobile.onSuccessGPSPosition):"+er.message)}},onErrorGPSPosition:function(p_error){try{$.Oda.Mobile.positionGps.statut="KO : code=>"+p_error.code+", message=>"+p_error.message,$.Oda.Mobile.funcReturnGPSPosition($.Oda.Mobile.positionGps)}catch(er){$.Oda.Log.error(0,"ERROR($.Oda.Mobile.onErrorGPSPosition):"+er.message)}},onPhotoSuccess:function(p_imageData){try{var imgSrc="data:image/jpeg;base64,"+p_imageData;$.Oda.Mobile.funcReturnCaptureImg(imgSrc)}catch(er){$.Oda.Log.error(0,"ERROR($.Oda.Mobile.onPhotoSuccess):"+er.message)}},onPhotoURISuccess:function(p_imageURI){try{var imgSrc=p_imageURI;$.Oda.Mobile.funcReturnCaptureImg(imgSrc)}catch(er){$.Oda.Log.error(0,"ERROR($.Oda.Mobile.onPhotoURISuccess):"+er.message)}},onPhotoFail:function(p_message){try{alert("Failed because: "+p_message)}catch(er){$.Oda.Log.error(0,"ERROR($.Oda.Mobile.onPhotoFail):"+er.message)}},initModuleMobile:function(){try{var boolRetour=!0;return $.Oda.Mobile.networkState=navigator.connection.type,$.Oda.Mobile.pictureSource=navigator.camera.PictureSourceType,$.Oda.Mobile.destinationType=navigator.camera.DestinationType,boolRetour}catch(er){return $.Oda.Log.error(0,"ERROR($.Oda.Mobile.initModuleMobile):"+er.message),null}},getConnectionString:function(p_networkState){try{var retour="",states={};return states[Connection.UNKNOWN]="Unknown connection",states[Connection.ETHERNET]="Ethernet connection",states[Connection.WIFI]="WiFi connection",states[Connection.CELL_2G]="Cell 2G connection",states[Connection.CELL_3G]="Cell 3G connection",states[Connection.CELL_4G]="Cell 4G connection",states[Connection.NONE]="No network connection",retour="Connection type: "+states[p_networkState]}catch(er){return $.Oda.Log.error(0,"ERROR($.Oda.Mobile.getConnectionString):"+er.message),null}},testConnection:function(){try{var boolRetour=!0;return alert(this.getConnectionString(_networkState)),boolRetour}catch(er){return $.Oda.Log.error(0,"ERROR($.Oda.Mobile.testConnection):"+er.message),null}},getGpsPosition:function(p_onReturn){try{var boolRetour=!0;return $.Oda.Mobile.funcReturnGPSPosition=p_onReturn,navigator.geolocation.getCurrentPosition(_onSuccessGPSPosition,_onErrorGPSPosition),boolRetour}catch(er){return $.Oda.Log.error(0,"ERROR($.Oda.Mobile.getGpsPosition):"+er.message),null}},getGpsPositionString:function(p_position){try{var retour="";return retour+="Latitude: "+p_position.coords.latitude+"\nLongitude: "+p_position.coords.longitude+"\nAltitude: "+p_position.coords.altitude+"\nAccuracy: "+p_position.coords.accuracy+"\nAltitude Accuracy: "+p_position.coords.altitudeAccuracy+"\nHeading: "+p_position.coords.heading+"\nSpeed: "+p_position.coords.speed+"\nTimestamp: "+p_position.timestamp+"\nstatut: "+p_position.statut+"\n"}catch(er){return $.Oda.Log.error(0,"ERROR($.Oda.Mobile.getGpsPositionString):"+er.message),null}},getPhotoFromCamera:function(p_retourCapture){try{var boolRetour=!0;return $.Oda.Mobile.funcReturnCaptureImg=p_retourCapture,navigator.camera.getPicture(_onPhotoSuccess,_onPhotoFail,{quality:50,destinationType:_destinationType.DATA_URL}),boolRetour}catch(er){return $.Oda.Log.error(0,"ERROR($.Oda.Mobile.getPhotoFromCamera):"+er.message),null}},getPhotoFromLibrary:function(p_retourCapture){try{var boolRetour=!0;return $.Oda.Mobile.funcReturnCaptureImg=p_retourCapture,navigator.camera.getPicture(_onPhotoURISuccess,_onPhotoFail,{quality:50,destinationType:_destinationType.FILE_URI,sourceType:_pictureSource.PHOTOLIBRARY}),boolRetour}catch(er){return $.Oda.Log.error(0,"ERROR($.Oda.Mobile.getPhotoFromLibrary):"+er.message),null}}},MokUp:{mokup:[],get:function(params){try{var elt,strInterface=params.url.replace($.Oda.Context.rest,"");for(var indice in $.Oda.MokUp.mokup)if($.Oda.MokUp.mokup[indice]["interface"]===strInterface){elt=$.Oda.MokUp.mokup[indice];break}var defaultValue=null,value=null;if($.Oda.Tooling.isUndefined(elt))return{strErreur:"No mokup found for "+strInterface,data:{},statut:4};var attrs=$.Oda.Tooling.clone(params.tabInput);attrs.hasOwnProperty("ctrl")&&delete attrs.ctrl,attrs.hasOwnProperty("milis")&&delete attrs.milis,attrs.hasOwnProperty("keyAuthODA")&&delete attrs.keyAuthODA;for(var indice in elt.value)if("default"===elt.value[indice].args&&(defaultValue=elt.value[indice]["return"]),$.Oda.Tooling.deepEqual(elt.value[indice].args,attrs)){value=elt.value[indice]["return"];break}return null===value?defaultValue:value}catch(er){return $.Oda.Log.error("$.Oda.MokUp.get : "+er.message),null}}},Event:{addListener:function(p_params){try{return $.Oda.Context.window.addEventListener(p_params.name,p_params.callback,!1),this}catch(er){return $.Oda.Log.error("$.Oda.Event.addListener : "+er.message),null}},send:function(p_params){try{p_params.hasOwnProperty("data")||(p_params.data={});var event=new CustomEvent(p_params.name,{detail:p_params.data});return $.Oda.Context.window.dispatchEvent(event),this}catch(er){return $.Oda.Log.error("$.Oda.Event.send : "+er.message),null}}},Date:{getStrDateFR:function(){try{var currentTime=new Date,annee=currentTime.getFullYear(),mois=$.Oda.Tooling.pad2(currentTime.getMonth()+1),jour=$.Oda.Tooling.pad2(currentTime.getDate()),strDate=jour+"/"+mois+"/"+annee;return strDate}catch(er){return $.Oda.Log.error("$.Oda.Date.getStrDateFR() : "+er.message),null}},getStrDateTimeFrFromUs:function(p_strDateTime){try{var strDate="";return strDate=p_strDateTime.substr(8,2)+"/"+p_strDateTime.substr(5,2)+"/"+p_strDateTime.substr(0,4)+" "+p_strDateTime.substr(10,p_strDateTime.length-10)}catch(er){return $.Oda.Log.error("$.Oda.Date.getStrDateTimeFrFromUs : "+er.message),null}},getStrDateFrFromUs:function(p_strDate){try{var strDate="";return strDate=p_strDate.substr(8,2)+"/"+p_strDate.substr(5,2)+"/"+p_strDate.substr(0,4)}catch(er){return $.Oda.Log.error("$.Oda.Date.getStrDateFrFromUs : "+er.message),null}},convertSecondsToTime:function(p_second){try{var sec_num=p_second,hours=Math.floor(sec_num/3600),minutes=Math.floor((sec_num-3600*hours)/60),seconds=sec_num-3600*hours-60*minutes;10>hours&&(hours="0"+hours),10>minutes&&(minutes="0"+minutes),10>seconds&&(seconds="0"+seconds);var time=hours+":"+minutes+":"+seconds;return time}catch(er){return $.Oda.Log.error("$.Oda.Date.convertSecondsToTime : "+er.message),null}},getStrDateTime:function(){try{var currentTime=new Date,hours=$.Oda.Tooling.pad2(currentTime.getHours()),minutes=$.Oda.Tooling.pad2(currentTime.getMinutes()),annee=currentTime.getFullYear(),mois=$.Oda.Tooling.pad2(currentTime.getMonth()+1),jour=$.Oda.Tooling.pad2(currentTime.getDate()),secondes=$.Oda.Tooling.pad2(currentTime.getSeconds()),strDateTime=annee+"/"+mois+"/"+jour+" "+hours+":"+minutes+":"+secondes;return strDateTime}catch(er){return $.Oda.Log.error("$.Oda.Date.getStrDateTime : "+er.message),null}}},Interface:{call:function(params){var response={strErreur:"No call",data:{},statut:4};if(params.odaInterface.length>0){var theInterface=params.odaInterface[0];params.odaInterface.splice(0,1),response=$.Oda.Interface.Methode[theInterface](params)}return response},callRest:function(p_url,p_tabSetting,p_tabInput){try{var interfaces=$.Oda.Tooling.clone($.Oda.Context.modeInterface),jsonAjaxParam={url:p_url,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",type:"GET",async:p_tabSetting.hasOwnProperty("functionRetour"),odaInterface:interfaces,context:{}};p_tabSetting.hasOwnProperty("odaCacheOnDemande")||(p_tabSetting.odaCacheOnDemande=!1);var session=$.Oda.Storage.get("ODA-SESSION"),key=null;null!==session?key=session.key:(key=p_tabInput.keyAuthODA,delete p_tabInput.keyAuthODA),void 0===p_tabInput&&(p_tabInput={}),p_tabInput.milis=$.Oda.Tooling.getMilise(),p_tabInput.ctrl="OK",p_tabInput.keyAuthODA=key,jsonAjaxParam.data=p_tabInput;for(var indice in p_tabSetting)jsonAjaxParam[indice]=p_tabSetting[indice];return jsonAjaxParam.context.odaKey=p_url,jsonAjaxParam.context.odaAttrs=p_tabInput,$.Oda.Interface.call(jsonAjaxParam)}catch(er){var msg="$.Oda.Interface.callRest : "+er.message;return $.Oda.Log.error(msg),null}},Methode:{ajax:function(params){{var retour;$.ajax(params).done(function(data,textStatus,jqXHR){if("object"==typeof data?!data.hasOwnProperty("strErreur")||"key auth expiree."!=data.strErreur&&"key auth invalid."!=data.strErreur||$.Oda.Security.logout():"json"===params.dataType&&(data={strErreur:data,data:{},statut:4}),""!==data.strErreur)$.Oda.Event.send({name:"oda-notification-flash",data:{type:"error",msg:"$.Oda.Interface.Methode.ajax : "+data.strErreur}});else if($.Oda.Tooling.isInArray("cache",$.Oda.Context.modeInterface)){var attrs=$.Oda.Tooling.clone(this.odaAttrs);attrs.hasOwnProperty("ctrl")&&delete attrs.ctrl,attrs.hasOwnProperty("milis")&&delete attrs.milis,attrs.hasOwnProperty("keyAuthODA")&&delete attrs.keyAuthODA,$.Oda.Cache.save({key:this.odaKey,attrs:attrs,datas:data})}$.Oda.Log.debug("Call ajax success for : "+params.url),data.context=this,$.Oda.Tooling.isUndefined(params.functionRetour)?retour=data:params.functionRetour(data)}).fail(function(jqXHR,textStatus,errorThrown){var msg=textStatus+" - "+errorThrown.message+" on "+params.url;$.Oda.Log.error("$.Oda.Interface.Methode.ajax : "+msg);var data={strErreur:msg,data:{},statut:404};params.odaInterface.length>0&&"error"===textStatus?retour=$.Oda.Interface.call(params):($.Oda.Display.Notification.error(msg),data.context=this,$.Oda.Tooling.isUndefined(params.functionRetour)?retour=data:params.functionRetour(data))})}return retour},mokup:function(params){var retour=$.Oda.MokUp.get({url:params.url,tabInput:params.data});return retour.context=params.context,retour.strErreur.startsWith("No mokup found for")&&params.odaInterface.length>0?$.Oda.Interface.call(params):($.Oda.Log.debug("Call mokup success for : "+params.url),$.Oda.Tooling.isUndefined(params.functionRetour)?retour:void params.functionRetour(retour))},cache:function(params){var attrs=$.Oda.Tooling.clone(params.data);attrs.hasOwnProperty("ctrl")&&delete attrs.ctrl,attrs.hasOwnProperty("milis")&&delete attrs.milis,attrs.hasOwnProperty("keyAuthODA")&&delete attrs.keyAuthODA;var retour=$.Oda.Cache.load({key:params.url,attrs:attrs,demande:params.odaCacheOnDemande});if(retour){var datas=retour.datas;return datas.context=params.context,$.Oda.Log.debug("Call cache success for : "+params.url),$.Oda.Tooling.isUndefined(params.functionRetour)?datas:void params.functionRetour(datas)}if(params.odaInterface.length>0)return $.Oda.Interface.call(params);var msg="No found in cache : "+params.url+", and cache is the last interface.",data={strErreur:msg,data:{},statut:404};return $.Oda.Log.error(msg),data.context=params.context,$.Oda.Tooling.isUndefined(params.functionRetour)?data:void params.functionRetour(data)},offline:function(params){try{var attrs=$.Oda.Tooling.clone(params.data);attrs.hasOwnProperty("ctrl")&&delete attrs.ctrl,attrs.hasOwnProperty("milis")&&delete attrs.milis,attrs.hasOwnProperty("keyAuthODA")&&delete attrs.keyAuthODA;var retour=$.Oda.Cache.loadWithOutTtl({key:params.url,attrs:attrs});if(retour){var datas=retour.datas;return datas.context=params.context,$.Oda.Log.debug("Call offline success for : "+params.url),$.Oda.Tooling.isUndefined(params.functionRetour)?datas:void params.functionRetour(datas)}if(params.odaInterface.length>0)return $.Oda.Interface.call(params);var msg="No found in offline : "+params.url+", and offline is the last interface.",data={strErreur:msg,data:{},statut:404};return $.Oda.Log.error(msg),data.context=params.context,$.Oda.Tooling.isUndefined(params.functionRetour)?data:void params.functionRetour(data)}catch(er){return $.Oda.Log.error("$.Oda.Interface.offline : "+er.message),null}}},getParameter:function(p_param_name){try{var strResponse,tabInput={param_name:p_param_name},json_retour=$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/getParam.php",{},tabInput);if(""===json_retour.strErreur){var type=json_retour.data.leParametre.param_type,value=json_retour.data.leParametre.param_value;switch(type){case"int":strResponse=parseInt(value);break;case"float":strResponse=$.Oda.Tooling.arrondir(parseFloat(value),2);break;case"varchar":strResponse=value;break;default:strResponse=value}}return strResponse}catch(er){return $.Oda.Log.error("$.Oda.Interface.getParameter : "+er.message),null}},getRangs:function(){try{var valeur=$.Oda.Storage.get("ODA_rangs");if(null===valeur){var tabInput={sql:"Select `labelle`,`indice` FROM `api_tab_rangs` ORDER BY `indice` desc"},retour=$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/getSQL.php",{type:"POST"},tabInput);""===retour.strErreur?valeur=retour.data.resultat.data:$.Oda.Display.Notification.error(retour.strErreur),$.Oda.Storage.set("ODA_rangs",valeur,$.Oda.Storage.ttl_default)}return valeur}catch(er){return $.Oda.Log.error("$.Oda.Interface.geRangs : "+er.message),null}},addStat:function(p_user,p_page,p_action){try{var tabSetting={functionRetour:function(){}},tabInput={user:p_user,page:p_page,action:p_action},retour=$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/addStat.php",tabSetting,tabInput);return retour}catch(er){return $.Oda.Log.error("$.Oda.Interface.addStat : "+er.message),null}},sendMail:function(p_params){try{var params_attempt={email_mails_dest:null,message_html:null,sujet:null},params=$.Oda.Tooling.checkParams(p_params,params_attempt);if(null===params)return!1;var returns=$.Oda.Interface.callRest($.Oda.Context.rest+"API/scriptphp/send_mail.php",{type:"POST"},params);return returns}catch(er){return $.Oda.Log.error("$.Oda.Interface.sendMail) :"+er.message),null}}},Display:{render:function(p_params){try{return $("#"+p_params.id).html(p_params.html),$.Oda.Scope.init({id:p_params.id}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.render : "+er.message),null}},Notification:{id:0,success:function(p_message){this.create(p_message,"success",2e3)},info:function(p_message){this.create(p_message,"info",3e3)},warning:function(p_message){this.create(p_message,"warning",5e3)},danger:function(p_message){this.create(p_message,"danger")},error:function(p_message){this.create(p_message,"danger"),$.Oda.Log.error(p_message)},load:function(p_params){try{var html=$.Oda.Display.TemplateHtml.create({template:"oda-notification-tpl"});return $("body").append(html),$.Oda.Event.addListener({name:"oda-notification-flash",callback:function(e){return $.Oda.Display.Notification[e.detail.type](e.detail.msg),this}}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Notification.load : "+er.message),null}},create:function(p_message,p_type,time){try{$.Oda.Display.Notification.id++;var strHtml="";return strHtml+="",strHtml+='<div class="alert alert-'+p_type+' alert-dismissible" style="text-align:center;" id="oda-notification-'+$.Oda.Display.Notification.id+'">',strHtml+='<button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>',strHtml+=p_message,strHtml+="</div>",
$("#oda-notification").append(strHtml),$.Oda.Tooling.isUndefined(time)||$.Oda.Tooling.timeout($.Oda.Display.Notification.remove,time,{id:$.Oda.Display.Notification.id}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Notification.create :"+er.message),null}},remove:function(params){try{return $("#oda-notification-"+params.id).fadeOut(500,function(){$(this).remove()}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Notification.remove :"+er.message),null}}},Scene:{load:function(p_params){try{var htmlScene=$.Oda.Display.TemplateHtml.create({template:"oda-scene-tpl"});$("body").append(htmlScene);var htmlTudo=$.Oda.Display.TemplateHtml.create({template:"oda-tuto-tpl"});return $("body").append(htmlTudo),$("#avatar").click(function(e){e.preventDefault(),$("#wrapper").toggleClass("toggled")}),$(document).ready(function(){$(".iconProfile").hover(function(){$(this).addClass("transition")},function(){$(this).removeClass("transition")})}),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Scene.load : "+er.message),null}}},loading:function(p_params){try{return p_params.elt.html('<img SRC="API/img/loading.gif" ALT="Chargement" TITLE="Chargement">'),this}catch(er){return $.Oda.Log.error("$.Oda.Display.loading : "+er.message),null}},MenuSlide:{display:!1,show:function(){try{if(!this.display){var strHtml="";strHtml+="<li class=\"sidebar-brand\"><a href=\"javascript:$.Oda.Router.navigateTo({'route':'profile','args':[]});\">"+$.Oda.Session.userInfo.firstName+" "+$.Oda.Session.userInfo.lastName+"</a></li>",strHtml+="<li><a href=\"javascript:$.Oda.Router.navigateTo({'route':'profile','args':[]});\" oda-label=\"oda-main.profile\">Your profile</a></li>",strHtml+="<li><a href=\"javascript:$.Oda.Router.navigateTo({'route':'contact','args':[]});\" oda-label=\"oda-main.contact\">Contact</a></li>",strHtml+='<li><a href="javascript:$.Oda.Security.logout();" oda-label="oda-main.logout">Logout</a></li>',$("#menuSlide").html(strHtml),this.display=!0}}catch(er){$.Oda.Log.error("$.Oda.Display.MenuSlide.show : "+er.message)}},remove:function(){try{$("#wrapper").removeClass("toggled"),$("#menuSlide").html('<li class="sidebar-brand" id="profileDisplay"><span oda-label="oda-project.userLabel">Profile Name</span></li><li class="divider"></li><li><a href="javascript:$.Oda.Router.navigateTo({\'route\':\'contact\',\'args\':[]});" oda-label="oda-main.contact">Contact</a></li>'),this.display=!1}catch(er){$.Oda.Log.error("$.Oda.Display.MenuSlide.remove : "+er.message)}}},Menu:{display:!1,show:function(){try{if(!this.display){{var tabInput={rang:$.Oda.Session.userInfo.profile,id_page:0};$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/getMenu.php",{functionRetour:function(retour){var strHTML="";if(""===retour.strErreur){var datas=retour.data.resultat.data,cate="";for(var indice in datas)if("98"!==datas[indice].id_categorie&&"1"!==datas[indice].id_categorie){datas[indice].id_categorie!==cate&&(cate=datas[indice].id_categorie,"0"!==indice&&(strHTML+="</ul></li>"),strHTML+='<li class="dropdown"><a class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">'+datas[indice].Description_cate+'<span class="caret"></span></a><ul class="dropdown-menu" role="menu">');var route=datas[indice].Lien;route=route.replace("api_page_",""),route=route.replace("page_",""),route=route.replace(".html",""),strHTML+="<li><a href=\"javascript:$.Oda.Router.navigateTo({'route':'"+route+"','args':[]});\">"+datas[indice].Description_courte+"</a></li>"}$("#menu").html(strHTML)}}},tabInput)}this.display=!0}}catch(er){$.Oda.Log.error("$.Oda.Display.Menu.show : "+er.message)}},remove:function(){try{$("#menu").html(""),this.display=!1}catch(er){$.Oda.Log.error("$.Oda.Display.Menu.remove : "+er.message)}}},Message:{show:function(p_params){try{{var tabInput={code_user:$.Oda.Session.code_user};$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/getMessagesToDisplay.php",{functionRetour:function(datas){if(""===datas.strErreur)for(var indice in datas.data.messages.data){var message=datas.data.messages.data[indice];if(!$("#oda-message-"+message.id).length){var strHtml="";strHtml+="",strHtml+='<div class="alert alert-'+message.niveau+' alert-dismissible" id="oda-message-'+message.id+'" style="width:90%;margin-left:auto;margin-right:auto;">',strHtml+='<button type="button" class="close" data-dismiss="alert" aria-label="Close" onclick="$.Oda.Display.Message.hide({id:\''+message.id+'\'});"><span aria-hidden="true">&times;</span></button>',strHtml+=message.message,strHtml+="</div>",$("#"+$.Oda.Context.mainDiv).before(strHtml)}}else $.Oda.Display.Notification.error(datas.strErreur)}},tabInput)}return this}catch(er){return $.Oda.Log.error("$.Oda.Display.Message.show : "+er.message),null}},hide:function(p_params){try{var tabInput={code_user:$.Oda.Session.code_user,id:p_params.id},retour=$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/setMessagesLus.php",{functionRetour:function(datas){""===retour.strErreur?$("#oda-message-"+p_params.id).remove():$.Oda.Display.Notification.error(datas.strErreur)}},tabInput);return this}catch(er){return $.Oda.Log.error("$.Oda.Display.Message.hide  : "+er.message),null}}},Popup:{load:function(p_params){try{var htmlPopUp=$.Oda.Display.TemplateHtml.create({template:"oda-popup-tpl"});return $("body").append(htmlPopUp),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Popup.load : "+er.message),null}},open:function(p_params){try{p_params.hasOwnProperty("size")&&$("#oda-popup .modal-dialog").addClass("modal-"+p_params.size),$("#oda-popup_label").html("<b>"+p_params.label+"</b>"),$.Oda.Scope.init({id:"oda-popup_label"});var contentPopup=p_params.details;$("#oda-popup_content").html(contentPopup),$.Oda.Scope.init({id:"oda-popup_content"}),$("#oda-popup_footer").html(p_params.hasOwnProperty("footer")?p_params.footer:'<button type="button" class="btn btn-default" data-dismiss="modal" oda-label="oda-main.bt-close"></button>'),$.Oda.Scope.init({id:"oda-popup_footer"}),p_params.hasOwnProperty("callback")?$("#oda-popup").on("shown.bs.modal",function(e){p_params.hasOwnProperty("callbackParams")?p_params.callback(p_params.callbackParams):p_params.callback()}):$("#oda-popup").unbind("shown.bs.modal"),$("#oda-popup").modal("show")}catch(er){$.Oda.Log.error("$.Oda.Display.Popup.open : "+er.message)}},close:function(p_params){try{return $("#oda-popup_label").html(""),$("#oda-popup_content").html(""),$("#oda-popup_footer").html(""),$("#oda-popup").modal("hide"),this}catch(er){return $.Oda.Log.error("$.Oda.Display.Popup.close : "+er.message),null}}},TemplateHtml:{create:function(p_params){try{var strHtml=$("#"+p_params.template).html();if(p_params.hasOwnProperty("scope")){var listExpression=$.Oda.Tooling.findBetweenWords({str:$("#"+p_params.template).html(),first:"{{",last:"}}"});for(var indice in listExpression){var resultEval=$.Oda.Display.TemplateHtml.eval({exrp:listExpression[indice],scope:p_params.scope});strHtml=$.Oda.Tooling.replaceAll({str:strHtml,find:"{{"+listExpression[indice]+"}}",by:resultEval})}}return strHtml}catch(er){return $.Oda.Log.error("$.Oda.Display.TemplateHtml.create : "+er.message),null}},eval:function(p_params){try{var source="(function("+Object.keys(p_params.scope).join(", ")+") { return "+p_params.exrp+";})",compiled=eval(source),result=[];for(var property in p_params.scope)p_params.scope.hasOwnProperty(property)&&result.push(p_params.scope[property]);var result=compiled.apply(p_params.scope,result);return result}catch(er){return $.Oda.Log.error("$.Oda.Display.TemplateHtml.eval : "+er.message),null}}}},App:{},Tooling:{checkParams:function(p_params,p_def){try{var params=$.Oda.Tooling.clone(p_params),param_return={};for(var key in p_def){if(null===p_def[key]){if("undefined"==typeof params[key]){var myUserException=new UserException("Param : "+key+" missing");throw myUserException}param_return[key]=params[key]}else param_return[key]="undefined"==typeof params[key]?p_def[key]:params[key];delete params[key]}for(var key in params)param_return[key]=params[key];return param_return}catch(er){return $.Oda.Log.error("$.Oda.Tooling.checkParams : "+er.message),null}},timeout:function(func,time,arg){try{return setTimeout(func,time,arg),this}catch(er){return $.Oda.Log.error("$.Oda.Tooling.timeout : "+er.message),null}},arrondir:function(p_value,p_precision){try{var retour=0,coef=Math.pow(10,p_precision);return retour=0!==coef?Math.round(p_value*coef)/coef:Math.round(p_value)}catch(er){return $.Oda.Log.error("$.Oda.Tooling.arrondir : "+er.message),null}},clone:function(p_params){try{if(null===p_params||"object"!=typeof p_params)return p_params;var copy=p_params.constructor();for(var attr in p_params)p_params.hasOwnProperty(attr)&&(copy[attr]=p_params[attr]);return copy}catch(er){return $.Oda.Log.error("$.Oda.Tooling.clone : "+er.message),null}},deepEqual:function(elt1,elt2){try{if("object"==typeof elt1&&null!==elt1&&"object"==typeof elt2&&null!==elt2){if(Object.keys(elt1).length!==Object.keys(elt2).length)return!1;for(var prop in elt1){if(!elt2.hasOwnProperty(prop))return!1;if(!$.Oda.Tooling.deepEqual(elt1[prop],elt2[prop]))return!1}return!0}return elt1!==elt2?!1:!0}catch(er){return $.Oda.Log.error("$.Oda.Tooling.deepEqual : "+er.message),null}},decodeHtml:function(html){try{var decoded=$("<div/>").html(html).text();return decoded}catch(er){return $.Oda.Log.error("$.Oda.Tooling.decodeHtml : "+er.message),null}},findBetweenWords:function(p_params){try{var r=new RegExp(p_params.first+"(.*?)"+p_params.last,"gm"),list=p_params.str.match(r);for(var indice in list)list[indice]=list[indice].replace(p_params.first,"").replace(p_params.last,"");return list}catch(er){return $.Oda.Log.error("$.Oda.Tooling.findBetweenWords : "+er.message),null}},replaceAll:function(p_params){try{var str=p_params.find.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),re=new RegExp(str,"g"),strReturn=p_params.str.replace(re,p_params.by);return strReturn}catch(er){return $.Oda.Log.error("$.Oda.Tooling.replaceAll : "+er.message),null}},clearSlashes:function(string){try{return string.toString().replace(/\/$/,"").replace(/^\//,"")}catch(er){return $.Oda.Log.error("$.Oda.Tooling.clearSlashes : "+er.message),null}},getListValeurPourAttribut:function(p_obj,p_attribut,p_type){try{var retour=[];for(var indice in p_obj)for(var key in p_obj[indice])if(key===p_attribut)if("undefined"!=typeof p_type){var valeur=null;valeur="int"===p_type?parseInt(p_obj[indice][key]):"float"===p_type?parseFloat(p_obj[indice][key]):new p_type(p_obj[indice][key]),retour[retour.length]=valeur}else retour[retour.length]=p_obj[indice][key];return retour}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getListValeurPourAttribut : "+er.message),null}},isInArray:function(p_value,p_array){try{var boolRetour=!1;for(var indice in p_array)if(p_value===p_array[indice]){boolRetour=!0;break}return boolRetour}catch(er){return $.Oda.Log.error("$.Oda.Tooling.isInArray : "+er.message),null}},isUndefined:function(p_object){try{var boolReturn=!0;return"undefined"!=typeof p_object&&(boolReturn=!1),boolReturn}catch(er){return $.Oda.Log.error("$.Oda.Tooling.isUndefined : "+er.message),null}},getMilise:function(){try{var d=new Date;return d.getTime()}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getMilise : "+er.message),null}},getParameterGet:function(p_params){try{var result={},tableau=decodeURI(p_params.url).split("?");if(tableau.length>1){tableau=tableau[1],tableau=tableau.split("&");for(var indice in tableau){var tmp=tableau[indice].split("=");result[tmp[0]]=tmp[1]}}return result}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getParameterGet : "+er.message),null}},getParamsLibrary:function(p_params){try{var listParams={};return $("script[src*='"+p_params.library+"']").each(function(index,value){var src=$(value).attr("src");listParams=$.Oda.Tooling.getParameterGet({url:src})}),listParams}catch(er){return $.Oda.Log.error("$.Oda.Tooling.getParamsLibrary : "+er.message),null}},objectSize:function(obj){try{var key,size=0;for(key in obj)obj.hasOwnProperty(key)&&size++;return size}catch(er){return $.Oda.Log.error("$.Oda.Tooling.objectSize : "+er.message),null}},objDataTableFromJsonArray:function(p_JsonArray){try{var objRetour={statut:"ok"},arrayEntete={},i=0;for(var key in p_JsonArray[0])arrayEntete[key]=i,i++;objRetour.entete=arrayEntete;var arrayData=[];for(var indice in p_JsonArray){var subArrayData=[];for(var key in p_JsonArray[indice])subArrayData[subArrayData.length]=p_JsonArray[indice][key];arrayData[arrayData.length]=subArrayData}return objRetour.data=arrayData,objRetour}catch(er){$.Oda.Log.error("$.Oda.Tooling.objDataTableFromJsonArray : "+er.message);var objRetour={statut:"ko"};return objRetour}},pad2:function(number){try{return(10>number?"0":"")+number}catch(er){return $.Oda.Log.error("$.Oda.Tooling.pad2 : "+er.message),null}}},I8n:{datas:[],get:function(p_group,p_tag){try{var returnvalue="Not define";for(var grpId in $.Oda.I8n.datas){var grp=$.Oda.I8n.datas[grpId];if(grp.groupName===p_group){var trad=grp[$.Oda.Session.userInfo.locale][p_tag];$.Oda.Tooling.isUndefined(trad)||(returnvalue=trad);break}}return returnvalue}catch(er){return $.Oda.Log.error("$.Oda.I8n.get : "+er.message),null}},getByString:function(p_tag){try{var returnvalue=p_tag,tab=p_tag.split(".");return tab.length>1&&"Not define"!==$.Oda.I8n.get(tab[0],tab[1])?$.Oda.I8n.get(tab[0],tab[1]):returnvalue}catch(er){return $.Oda.Log.error("$.Oda.I8n.getByString : "+er.message),null}}},Security:{auth:function(p_params){try{var tabInput={login:p_params.login,mdp:p_params.mdp},returns=$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/getAuth.php",{},tabInput);if(""===returns.strErreur){var code_user=returns.data.resultat.code_user.toUpperCase(),key=returns.data.resultat.keyAuthODA,session={code_user:code_user,key:key},tabSetting={},tabInput={code_user:code_user},retour=$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/getAuthInfo.php",tabSetting,tabInput);if(""===retour.strErreur){var userInfo={locale:retour.data.resultat.langue,firstName:retour.data.resultat.nom,lastName:retour.data.resultat.prenom,mail:retour.data.resultat.mail,profile:retour.data.resultat.profile,profileLabel:retour.data.resultat.labelle,showTooltip:retour.data.resultat.montrer_aide_ihm};session.userInfo=userInfo,$.Oda.Storage.set("ODA-SESSION",session,43200),$.Oda.Session=session,$.Oda.Security.loadRight()}else $.Oda.Storage.remove("ODA-SESSION"),$.Oda.Display.Notification.error(returns.strErreur);$.Oda.Router.routerExit=!1,p_params.reload&&$.Oda.Router.navigateTo()}else $.Oda.Display.Notification.error(returns.strErreur)}catch(er){return $.Oda.Log.Log.error("$.Oda.Security.auth : "+er.message),null}},loadRight:function(){try{$.Oda.Router.routesAllowed=$.Oda.Router.routesAllowedDefault.slice(0);{var tabInput={rang:$.Oda.Session.userInfo.profile,id_page:0};$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/getMenu.php",{functionRetour:function(data){var datas=data.data.resultat.data;for(var indice in datas)if("98"!==datas[indice].id_categorie&&"1"!==datas[indice].id_categorie){var route=datas[indice].Lien;route=route.replace("api_page_",""),route=route.replace("page_",""),route=route.replace(".html",""),$.Oda.Router.routesAllowed.push(route)}}},tabInput)}}catch(er){$.Oda.Log.error("$.Oda.Security.loadRight() : "+er.message)}},logout:function(){try{var session=$.Oda.Storage.get("ODA-SESSION");if(null!==session){{var tabInput={key:session.key};$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/deleteSession.php",{},tabInput)}$.Oda.Storage.remove("ODA-SESSION")}$.Oda.Session={code_user:"",key:"",userInfo:{locale:"fr",firstName:"",lastName:"",mail:"",profile:0,profileLabel:"",showTooltip:0}},$.Oda.Display.MenuSlide.remove(),$.Oda.Display.Menu.remove(),$.Oda.Router.routes.auth.go()}catch(er){$.Oda.Log.error("$.Oda.Security.logout : "+er.message)}}},Controler:{Contact:{contact:function(p_reponse,p_message){try{var contact_mail_administrateur=$.Oda.Interface.getParameter("contact_mail_administrateur");if(""!==contact_mail_administrateur){var tabInput={reponse:p_reponse,message:p_message,code_user:$.Oda.Session.code_user},result=$.Oda.Interface.callRest($.Oda.Context.rest+"API/phpsql/insertContact.php",{},tabInput);if(""===result.strErreur){var message_html="",sujet="";message_html="",message_html+="<html><head></head><body>",message_html+="De : <pre>"+$.Oda.Session.code_user+"</pre>",message_html+="</br></br>",message_html+="Contact : <pre>"+p_reponse+"</pre>",message_html+="</br></br>",message_html+="Message : <pre>"+p_message+"</pre>",message_html+="</body></html>",sujet="[ODA-"+$.Oda.Interface.getParameter("nom_site")+"]Nouveau contact.";var paramsMail={email_mail_ori:contact_mail_administrateur,email_labelle_ori:"Service Mail ODA",email_mail_reply:contact_mail_administrateur,email_labelle_reply:"Service Mail ODA",email_mails_dest:contact_mail_administrateur,message_html:message_html,sujet:sujet},retour=$.Oda.Interface.sendMail(paramsMail);$("#mail").val(""),$("#name").val(""),$("#msg").val(""),retour&&$.Oda.Display.Notification.success("Demande bien soummise sous l'identifiant n&ordm;"+result.data.resultat+".")}else $.Oda.Display.Notification.error(result.strErreur)}else $.Oda.Display.Notification.error("Mail du service non définie.")}catch(er){$.Oda.Log.error("$.Oda.contact() : "+er.message)}}}},Worker:{lib:function(){this.$Oda={Context:{rest:"$$REST$$"},Session:{code_user:"$$CODEUSER$$",key:"$$ODAKEY$$"},message:function(cmd,parameter){try{this.cmd=cmd,this.parameter=parameter}catch(er){$Oda.log("ERROR($Oda.message : "+er.message)}},log:function(msg){console.log(msg)},callRest:function(p_url,p_tabSetting,p_tabInput){try{var jsonAjaxParam={url:p_url,contentType:"application/x-www-form-urlencoded; charset=UTF-8",dataType:"json",type:"GET"};p_tabInput.milis=this.getMilise(),p_tabInput.ctrl="OK",p_tabInput.keyAuthODA=this.Session.key,jsonAjaxParam.data=p_tabInput;var async=!0;null===p_tabSetting.functionRetour&&(async=!1,jsonAjaxParam.async=!1);for(var indice in p_tabSetting)jsonAjaxParam[indice]=p_tabSetting[indice];var v_retourSync=null,xhr_object=new XMLHttpRequest;switch(jsonAjaxParam.type){case"GET":case"get":var url=jsonAjaxParam.url+"?tag=1";for(var key in jsonAjaxParam.data){var param=jsonAjaxParam.data[key].toString();url+="&"+key+"="+param.replace(new RegExp("&","g"),"%26")}xhr_object.open(jsonAjaxParam.type,url,!1),xhr_object.send(null);break;case"POST":case"post":default:var params="tag=1";for(var key in jsonAjaxParam.data){var param=jsonAjaxParam.data[key].toString();params+="&"+key+"="+param.replace(new RegExp("&","g"),"%26")}xhr_object.open(jsonAjaxParam.type,jsonAjaxParam.url,!1),xhr_object.setRequestHeader("Content-type","application/x-www-form-urlencoded"),xhr_object.send(params)}switch(v_retourSync={strErreur:"No call",data:{},statut:4},jsonAjaxParam.dataType){case"json":v_retourSync=4===xhr_object.readyState&&200===xhr_object.status?JSON.parse(xhr_object.responseText):{strErreur:"$Oda.callRest : "+xhr_object.status+" "+xhr_object.statusText,data:{},statut:4};break;case"text":default:v_retourSync=4===xhr_object.readyState?xhr_object.responseText:"$Oda.callRest : "+xhr_object.status+" "+xhr_object.statusText}return delete self.xhr_object,v_retourSync}catch(er){var msg="ERROR($Oda.callRest) : "+er.message;return $Oda.log(msg),null}},getMilise:function(){try{var d=new Date;return d.getTime()}catch(er){return $Oda.log("ERROR($Oda.getMilise) : "+er.message),null}},arrondir:function(p_value,p_precision){try{var retour=0,coef=Math.pow(10,p_precision);return retour=0!==coef?Math.round(p_value*coef)/coef:Math.round(p_value)}catch(er){return $Oda.log("ERROR($Oda.arrondir) : "+er.message),null}}}},message:function(cmd,parameter){try{this.cmd=cmd,this.parameter=parameter}catch(er){$.Oda.Log.error("$Oda.message : "+er.message)}},initWorker:function(p_nameWorker,p_dataInit,p_functionCore,p_fonctionRetour){try{var strFunctionLib=$.Oda.Worker.lib.toString();strFunctionLib=strFunctionLib.substring(12),strFunctionLib=strFunctionLib.substring(0,strFunctionLib.length-1),strFunctionLib=strFunctionLib.replace("$$CODEUSER$$",$.Oda.Session.code_user),strFunctionLib=strFunctionLib.replace("$$ODAKEY$$",$.Oda.Session.key),strFunctionLib=strFunctionLib.replace("$$REST$$",$.Oda.Context.rest);var strFunctionCore=p_functionCore.toString();strFunctionCore=strFunctionCore.substring(12),strFunctionCore=strFunctionCore.substring(0,strFunctionCore.length-1);var blob=new Blob([strFunctionLib+strFunctionCore],{type:"application/javascript"}),monWorker=new Worker(window.URL.createObjectURL(blob));return monWorker.addEventListener("message",function(event){p_fonctionRetour(event.data)},!1),monWorker}catch(er){$.Oda.Log.error("$.Oda.Worker.initWorker : "+er.message)}},terminateWorker:function(p_worker){try{p_worker.terminate()}catch(er){$.Oda.Log.error("$.Oda.Worker.terminateWorker : "+er.message)}}},Tuto:{enable:!0,currentElt:"",listElt:[],start:function(){try{$.Oda.Tuto.enable&&$("[oda-tuto]").each(function(index,value){var theTuto={},def=$(value).attr("oda-tuto"),tabDef=def.split(";");for(var indice in tabDef){var elt=tabDef[indice],prop=elt.split(":");void 0!==prop[1]&&(theTuto[prop[0]]=prop[1])}$.Oda.Tuto.listElt.hasOwnProperty(theTuto.id)||($.Oda.Tuto.listElt[theTuto.id]={id:theTuto.id,enable:!0,props:theTuto});var sessionTuto=$.Oda.Storage.get("ODA-TUTO-"+$.Oda.Session.code_user,{});sessionTuto.hasOwnProperty(theTuto.id)?$.Oda.Tuto.listElt[theTuto.id].enable=sessionTuto[theTuto.id]:(sessionTuto[theTuto.id]=!0,$.Oda.Storage.set("ODA-TUTO-"+$.Oda.Session.code_user,sessionTuto)),$.Oda.Tuto.listElt[theTuto.id].enable&&""===$.Oda.Tuto.currentElt&&$.Oda.Tuto.show(theTuto.id)})}catch(er){$.Oda.Log.error("$.Oda.Tuto.start : "+er.message)}},readed:function(id){try{$.Oda.Tuto.listElt[id].enable=!1;var sessionTuto=$.Oda.Storage.get("ODA-TUTO-"+$.Oda.Session.code_user);sessionTuto[id]=!1,$.Oda.Storage.set("ODA-TUTO-"+$.Oda.Session.code_user,sessionTuto),$("[oda-tuto^='id:"+id+"']").tooltip("destroy");for(var elt in $.Oda.Tuto.listElt)if($.Oda.Tuto.listElt[elt].enable){this.show(elt);break}}catch(er){$.Oda.Log.error("$.Oda.Tuto.readed : "+er.message)}},show:function(id){try{var elt=$("[oda-tuto^='id:"+id+"']");$.Oda.Tuto.currentElt=id,elt.attr("data-toggle","tooltip"),$.Oda.Tuto.listElt[id].props.hasOwnProperty("location")&&elt.attr("data-placement",$.Oda.Tuto.listElt[id].props.location),elt.attr("data-html",!0);var strHtml=$("[oda-tuto-content="+id+"]").html();$.Oda.Tuto.listElt[id].props.hasOwnProperty("bt-next")&&(strHtml+=""),strHtml+='<br><button type="button" onclick="$.Oda.Tuto.readed(\''+id+'\');" class="btn btn-info btn-xs">Readed</button >',elt.attr("title",strHtml),elt.on("hidden.bs.tooltip",function(){$.Oda.Tuto.enable=!1,elt.tooltip("destroy")}),elt.tooltip("show")}catch(er){$.Oda.Log.error("$.Oda.Tuto.show : "+er.message)}}},Scope:{init:function(p_params){try{var divTarget="";$.Oda.Tooling.isUndefined(p_params)||(divTarget="#"+p_params.id+" "),$(divTarget+"oda-loading").each(function(index,value){$.Oda.Display.loading({elt:$(value)})}),$(divTarget+"[oda-input-text]").each(function(index,value){var id=$(value).attr("oda-input-text");$(value).attr("id",id),$(value).attr("name",id),$.Oda.Scope.checkInputText({elt:value}),$(value).keyup(function(elt){$.Oda.Scope.checkInputText({elt:elt.target}),$.Oda.Scope.refresh()});var placeHolder=$(value).attr("oda-input-text-placeholder");if(void 0!==placeHolder){var tab=placeHolder.split(".");tab.length>1&&"Not define"!==$.Oda.I8n.get(tab[0],tab[1])&&$(value).attr("placeholder",$.Oda.I8n.get(tab[0],tab[1]))}var odaTips=$(value).attr("oda-input-text-tips");if(void 0!==odaTips){var tab=odaTips.split(".");tab.length>1&&"Not define"!==$.Oda.I8n.get(tab[0],tab[1])&&($(value).after('<span style="color : #a1a1a1;" id="span-'+id+'">&nbsp;</span>'),$(value).focus(function(){$("#span-"+id).html($.Oda.I8n.get(tab[0],tab[1]))}),$(value).focusout(function(){$("#span-"+id).html("&nbsp;")}))}}),$(divTarget+"[oda-input-select]").each(function(index,value){var id=$(value).attr("oda-input-select");$(value).attr("id",id),$(value).attr("name",id),$.Oda.Scope.checkInputSelect({elt:value}),$(value).change(function(elt){$.Oda.Scope.checkInputSelect({elt:elt.target}),$.Oda.Scope.refresh()})}),$(divTarget+"[oda-label]").each(function(index,value){var labelName=$(value).attr("oda-label"),tab=labelName.split(".");$(value).html($.Oda.I8n.get(tab[0],tab[1]))});var nbOdaSubmit=0;$(divTarget+"[oda-submit]").each(function(index,value){nbOdaSubmit++;var id=$(value).attr("oda-submit");$(value).attr("id",id),$(document).unbind("keypress"),$(document).keypress(function(e){13===e.which&&($(value).hasClass("disabled")||$(value).click())})}),nbOdaSubmit>1&&$.Oda.Log.warning("Too many oda-submit in document.")}catch(er){$.Oda.Log.error("$.Oda.Scope.init : "+er.message)}},checkInputText:function(p_params){try{var $elt=$(p_params.elt),required=!$.Oda.Tooling.isUndefined($elt.attr("required"));if(!required||void 0!==$elt.val()&&""!==$elt.val()){var odaCheck=$elt.attr("oda-input-text-check");if(void 0!==odaCheck){odaCheck.startsWith("Oda.Regexs:")&&(odaCheck=odaCheck.replace("Oda.Regexs:",""),odaCheck=$.Oda.Regexs[odaCheck]);var patt=new RegExp(odaCheck,"g"),res=patt.test($elt.val());res?($elt.data("isOk",!0),$elt.css("border-color","#04B404")):($elt.data("isOk",!1),$elt.css("border-color","#FF0000"))}}else $elt.data("isOk",!1),$elt.css("border-color","#FF0000");return this}catch(er){return $.Oda.Log.error("$.Oda.Scope.checkInputText : "+er.message),null}},checkInputSelect:function(p_params){try{var $elt=$(p_params.elt),required=!$.Oda.Tooling.isUndefined($elt.attr("required"));return!required||void 0!==$elt.val()&&""!==$elt.val()?($elt.data("isOk",!0),$elt.css("border-color","#04B404")):($elt.data("isOk",!1),$elt.css("border-color","#FF0000")),this}catch(er){return $.Oda.Log.error("$.Oda.Scope.checkInputSelect : "+er.message),null}},refresh:function(){try{}catch(er){$.Oda.Log.error("$.Oda.Scope.refresh : "+er.message)}}},Storage:{version:VERSION,ttl_default:86400,storageKey:"ODA__default__",isStorageAvaible:function(){try{var boolRetour=!1;return localStorage&&(boolRetour=!0),boolRetour}catch(er){return $.Oda.Log.error("Oda.Storage.isStorageAvaible : "+er.message),null}},set:function(p_key,p_value,p_ttl){try{var boolRetour=!0,d=new Date,date=d.getTime(),ttl=0;"undefined"!=typeof p_ttl&&(ttl=p_ttl);var storage={value:p_value,recordDate:date,ttl:ttl};if(boolRetour){var data=JSON.stringify(storage),compressed=LZString.compress(data);localStorage.setItem(this.storageKey+p_key,compressed)}return boolRetour}catch(er){return $.Oda.Log.error("$.Oda.Storage.set : "+er.message),null}},get:function(p_key,p_default){try{var myValue=null,compressed=localStorage.getItem($.Oda.Storage.storageKey+p_key);if(null!==compressed){var data=LZString.decompress(compressed),myStorage=JSON.parse(data);if(myValue=myStorage.value,null!==myStorage.value&&0!==myStorage.ttl){var d=new Date,date=d.getTime(),dateTimeOut=myStorage.recordDate+1e3*myStorage.ttl;date>dateTimeOut&&(this.remove(p_key),myValue=null)}null===myValue&&"undefined"!=typeof p_default&&(this.set(p_key,p_default),myValue=p_default)}else"undefined"!=typeof p_default&&(this.set(p_key,p_default),myValue=p_default);return myValue}catch(er){return $.Oda.Log.error("$.Oda.Storage.get : "+er.message),null}},setTtl:function(p_key,p_ttl){try{var myValue=$.Oda.Storage.get(p_key),d=new Date,date=d.getTime(),storage={value:myValue,recordDate:date,ttl:p_ttl},myReturn=$.Oda.Storage.set($.Oda.Storage.storageKey+p_key,storage);return myReturn}catch(er){return $.Oda.Log.error("Oda.Storage.setTtl : "+er.message),null}},getTtl:function(p_key){try{var myReturn=0,myStorage=$.Oda.Storage.get($.Oda.Storage.storageKey+p_key);if(null!==myStorage){var d=new Date,date=d.getTime(),dateTimeOut=myValue.recordDate+1e3*myValue.ttl;myReturn=dateTimeOut-date,0>myReturn&&(myReturn=0)}return myReturn}catch(er){return $.Oda.Log.error("Oda.Storage.getTtl : "+er.message),null}},remove:function(p_key){try{var myReturn=!0;return localStorage.removeItem($.Oda.Storage.storageKey+p_key),myReturn}catch(er){return $.Oda.Log.error("Oda.Storage.setTtl : "+er.message),null}},reset:function(){try{var myReturn=!0;for(var indice in localStorage)localStorage.removeItem(indice);return myReturn}catch(er){return $.Oda.Log.error("Oda.Storage.reset : "+er.message),null}},getIndex:function(p_filtre){try{var myReturn=[],patt=new RegExp($.Oda.Storage.storageKey+p_filtre,"gi");for(var indice in localStorage){var res=patt.test(indice);res&&myReturn.push(indice)}return myReturn}catch(er){return $.Oda.Log.error("Oda.Storage.getIndex : "+er.message),null}}},Router:{current:{route:"",args:[]},routes:{},routerExit:!1,routesAllowed:[],routeDependencies:[],routesAllowedDefault:[],MiddleWares:{},navigateTo:function(p_request){try{$("#oda-popup").exists()&&$("#oda-popup").modal("hide"),$.Oda.Router.routerExit=!1,$.Oda.Tooling.isUndefined(p_request)&&(p_request=$.Oda.Router.current);for(var name in $.Oda.Router.routes)for(var indice in $.Oda.Router.routes[name].urls){var url=$.Oda.Router.routes[name].urls[indice];if(url===p_request.route)return $.Oda.Router.current=p_request,""!==$.Oda.Session.code_user&&$.Oda.Interface.addStat($.Oda.Session.code_user,$.Oda.Router.current.route,"request"),$.Oda.Router.routes[name].go(p_request),$("#wrapper").exists()&&$("#wrapper").removeClass("toggled"),this}return $.Oda.Log.error(p_request.route+" not found."),$.Oda.Router.routes[404].go(p_request),this}catch(er){return $.Oda.Log.error("$.ODa.Router.navigateTo : "+er.message),null}},addRoute:function(p_name,p_routeDef){try{return p_routeDef.hasOwnProperty("system")||(p_routeDef.system=!1),p_routeDef.go=function(p_request){$.Oda.Router.routerGo({routeDef:this,request:p_request})},p_routeDef.hasOwnProperty("middleWares")||(p_routeDef.middleWares=[]),p_routeDef.hasOwnProperty("dependencies")||(p_routeDef.dependencies=[]),$.Oda.Router.routes[p_name]=p_routeDef,this}catch(er){return $.Oda.Log.error("$.ODa.Router.addRoute : "+er.message),null}},addMiddleWare:function(p_name,p_midlleWareDef){try{return $.Oda.Router.MiddleWares[p_name]=p_midlleWareDef,$.Oda.Router.MiddleWares[p_name].name=p_name,this}catch(er){return $.Oda.Log.error("$.ODa.Router.addMiddleWare : "+er.message),null}},addDependencies:function(p_name,p_dependenciesLoad){try{return p_dependenciesLoad.name=p_name,$.Oda.Router.routeDependencies[p_name]=p_dependenciesLoad,this}catch(er){return $.Oda.Log.error("$.Oda.Router.addDependencies : "+er.message),null}},loadPartial:function(p_params){try{return $.get(p_params.routeDef.path,function(data){$("#"+$.Oda.Context.mainDiv).html(data),$.Oda.Scope.init({id:$.Oda.Context.mainDiv}),""!==$.Oda.Session.code_user&&$.Oda.Tuto.start()}),this}catch(er){return $.Oda.Log.error("$.Oda.Router.loadPartial : "+er.message),null}},startRooter:function(){try{$("#projectLabel").exists()&&$("#projectLabel").text($.Oda.Context.projectLabel),$("#"+$.Oda.Context.mainDiv).exists()||$(" body ").append('<!-- content --><div id="'+$.Oda.Context.mainDiv+'" class="container" style="padding-top:40px;"><oda-loading></oda-loading></div>');var hash=$.Oda.Context.window.location.hash;return $.Oda.Router.current={route:$.Oda.Tooling.clearSlashes(decodeURI(hash)).substring(1).replace(/\?(.*)$/,""),args:$.Oda.Tooling.getParameterGet({url:$.Oda.Context.window.location.hash})},this.navigateTo($.Oda.Router.current),this}catch(er){return $.Oda.Log.error("$.Oda.Router.startRooter : "+er.message),null}},routerGo:function(p_params){try{if($.Oda.Log.debug("RouterGo : "+p_params.routeDef.path),$.Oda.Display.loading({elt:$("#"+$.Oda.Context.mainDiv)}),!p_params.routeDef.system){var urlRoute=$.Oda.Router.current.route,urlArg="";for(var key in $.Oda.Router.current.args)"getUser"!==$.Oda.Router.current.args[key]&&"getPass"!==$.Oda.Router.current.args[key]&&(urlArg+=""===urlArg?"?":"&",urlArg+=key+"="+$.Oda.Router.current.args[key]);$.Oda.Context.window.location.hash=urlRoute+urlArg;var decoded=$.Oda.Tooling.decodeHtml($.Oda.I8n.getByString(p_params.routeDef.title));

$.Oda.Context.window.document.title=$.Oda.Context.projectLabel+" - "+decoded}var listDepends=[];for(var indice in p_params.routeDef.dependencies)listDepends=listDepends.concat($.Oda.Router.routeDependencies[p_params.routeDef.dependencies[indice]]);return $.Oda.Loader.load({depends:listDepends,functionFeedback:function(data){if(data.params.routeDef.middleWares.length>0)for(var indice in data.params.routeDef.middleWares)$.Oda.Router.MiddleWares[data.params.routeDef.middleWares[indice]]();return $.Oda.Router.routerExit&&!data.params.routeDef.system?!0:($.Oda.Context.ModeExecution.scene&&""!==$.Oda.Session.code_user&&($.Oda.Display.MenuSlide.show(),$.Oda.Display.Menu.show()),$.Oda.Context.ModeExecution.message&&""!==$.Oda.Session.code_user&&$.Oda.Display.Message.show(),void $.Oda.Router.loadPartial({routeDef:data.params.routeDef}))},functionFeedbackParams:{params:p_params}}),!0}catch(er){return $.Oda.Log.error("$.Oda.Router.routerGo : "+er.message),null}}},Google:{gapiStatuts:{zero:0,init:1,loaded:2,finish:3,fail:4},gapiStatut:0,gapi:null,clientId:"249758124548-fgt33dblm1r8jm0nh9snn53pkghpjtsu.apps.googleusercontent.com",apiKey:"PgCsKeWAsVGdOj3KjPn-JPS3",scopes:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email",trySessionAuth:0,methodeSessionAuthKo:null,methodeSessionAuthOk:null,sessionInfo:null,gaips:[],init:function(){try{switch($.Oda.Google.gapiStatut){case $.Oda.Google.gapiStatuts.zero:$.Oda.Google.gapiStatut=$.Oda.Google.gapiStatuts.init,$.getScript("https://apis.google.com/js/client.js?onload=handleClientLoad",function(){$.Oda.Google.handleClientLoad()});break;case $.Oda.Google.gapiStatuts.loaded:$.Oda.Log.debug("$.Oda.Google.init : already load.");break;default:$.Oda.Log.error("$.Oda.Google.init : client load fail.")}}catch(er){$.Oda.Log.error("$.Oda.Google.init :"+er.message)}},handleClientLoad:function(){try{gapi.hasOwnProperty("client")?($.Oda.Google.gapi=gapi,$.Oda.Google.gapiStatut=$.Oda.Google.gapiStatuts.loaded,$.Oda.Event.send({name:"oda-gapi-loaded"}),$.Oda.Log.debug("$.Oda.Google.handleClientLoad : finish.")):($.Oda.Log.debug("$.Oda.Google.handleClientLoad : waiting (gapi.client not loaded)"),$.Oda.Tooling.timeout($.Oda.Google.handleClientLoad,100))}catch(er){$.Oda.Log.error("$.Oda.Google.handleClientLoad :"+er.message)}},startSessionAuth:function(methodOk,methodKo){try{switch($.Oda.Tooling.isUndefined(methodOk)||($.Oda.Google.methodeSessionAuthOk=methodOk),$.Oda.Tooling.isUndefined(methodKo)||($.Oda.Google.methodeSessionAuthKo=methodKo),$.Oda.Google.gapiStatut){case $.Oda.Google.gapiStatuts.zero:$.Oda.Log.debug("$.Oda.Google.startSessionAuth : waiting (gapi not start)"),$.Oda.Google.init(),$.Oda.Event.addListener({name:"oda-gapi-loaded",callback:function(e){$.Oda.Google.startSessionAuth()}});break;case $.Oda.Google.gapiStatuts.loaded:$.Oda.Google.loadGapis([{api:"oauth2",version:"v2"}],$.Oda.Google.callbackAuthSession),$.Oda.Log.debug("$.Oda.Google.startSessionAuth : finish.");break;case $.Oda.Google.gapiStatuts.init:$.Oda.Log.debug("$.Oda.Google.startSessionAuth : waiting (gapi not loaded)"),$.Oda.Tooling.timeout($.Oda.Google.startSessionAuth,100);break;default:$.Oda.Log.error("$.Oda.Google.startSessionAuth : $.Oda.Google.gapi problem.")}}catch(er){$.Oda.Log.error("$.Oda.Google.startSessionAuth : "+er.message)}},loadGapis:function(tabApi,callbackFunction){try{if(tabApi.length>0){for(var indice in $.Oda.Google.gaips)if($.Oda.Google.gaips[indice].api===tabApi[0].api&&$.Oda.Google.gaips[indice].version===tabApi[0].version)return $.Oda.Log.debug("$.Oda.Google.loadGapis : Already ok pour "+tabApi[0].api+" en "+tabApi[0].version),tabApi.splice(0,1),$.Oda.Google.loadGapis(tabApi,callbackFunction),!0;$.Oda.Google.gapi.client.load(tabApi[0].api,tabApi[0].version,function(resp){"undefined"==typeof resp?($.Oda.Google.gaips.push({api:tabApi[0].api,version:tabApi[0].version}),$.Oda.Log.debug("$.Oda.Google.loadGapis : Chargement ok pour "+tabApi[0].api+" en "+tabApi[0].version),tabApi.splice(0,1),$.Oda.Google.loadGapis(tabApi,callbackFunction)):$.Oda.Log.debug("$.Oda.Google.loadGapis : Chargement ko pour "+tabApi[0].api+" en "+tabApi[0].version+"("+resp.error.message+")")})}else $.Oda.Log.debug("$.Oda.Google.loadGapis : finish."),callbackFunction()}catch(er){$.Oda.Log.error("$.Oda.Google.loadGapis :"+er.message)}},callbackAuthSession:function(){try{$.Oda.Google.gapi.client.setApiKey($.Oda.Google.apiKey),$.Oda.Google.gapi.auth.authorize({client_id:$.Oda.Google.clientId,scope:$.Oda.Google.scopes,immediate:!0},$.Oda.Google.handleAuthResult),$.Oda.Log.debug("$.Oda.Google.callbackAuthSession finish.")}catch(er){$.Oda.Log.error("$.Oda.Google.callbackAuthSession :"+er.message)}},handleAuthResult:function(authResult){try{authResult&&!authResult.error&&void 0!==authResult.access_token?($.Oda.Google.sessionInfo=authResult,$.Oda.Google.methodeSessionAuthOk()):$.Oda.Google.methodeSessionAuthKo(),$.Oda.Log.debug("$.Oda.Google.handleAuthResult finish.")}catch(er){$.Oda.Log.error("$.Oda.Google.handleAuthResult :"+er.message)}},callServiceGoogleAuth:function(callMethodeOk){try{$.Oda.Google.methodeSessionAuthOk=callMethodeOk,$.Oda.Google.gapi.auth.authorize({client_id:$.Oda.Google.clientId,scope:$.Oda.Google.scopes,immediate:!1},$.Oda.Google.handleAuthResult),$.Oda.Log.debug("$.Oda.Google.callServiceGoogleAuth finish.")}catch(er){$.Oda.Log.error("$.Oda.Google.callServiceGoogleAuth :"+er.message)}}},Log:{info:function(p_msg){try{return $.Oda.Context.console.info(p_msg),this}catch(er){return console.log("$.Oda.Log.info : "+er.message),null}},trace:function(p_msg){try{return $.Oda.Context.console.log(p_msg),this}catch(er){return console.log("$.Oda.Log.trace : "+er.message),null}},debug:function(p_msg){try{return $.Oda.Context.debug&&$.Oda.Context.console.debug(p_msg),this}catch(er){return console.log("$.Oda.Log.debug : "+er.message),null}},error:function(p_msg){try{return $.Oda.Context.console.error(p_msg),this}catch(er){return console.log("$.Oda.Log.error : "+er.message),null}},warning:function(p_msg){try{return $.Oda.Context.console.warn(p_msg),this}catch(er){return console.log("$.Oda.Log.warning : "+er.message),null}}}},$.Oda.Context.startDate=new Date;var params=$.Oda.Tooling.getParamsLibrary({library:"Oda"});if(params.hasOwnProperty("modeExecution"))switch(params.modeExecution){case"full":$.Oda.Context.ModeExecution.app=!0,$.Oda.Context.ModeExecution.scene=!0,$.Oda.Context.ModeExecution.init=!0,$.Oda.Context.ModeExecution.notification=!0,$.Oda.Context.ModeExecution.popup=!0,$.Oda.Context.ModeExecution.message=!0;break;case"app":$.Oda.Context.ModeExecution.app=!0,$.Oda.Context.ModeExecution.init=!0,$.Oda.Context.ModeExecution.notification=!0,$.Oda.Context.ModeExecution.popup=!0,$.Oda.Context.ModeExecution.message=!0;break;case"mini":$.Oda.Context.ModeExecution.init=!0,$.Oda.Context.ModeExecution.notification=!0,$.Oda.Context.ModeExecution.popup=!0,$.Oda.Context.ModeExecution.message=!0}$.Oda.Context.ModeExecution.init&&$.Oda.init()}();